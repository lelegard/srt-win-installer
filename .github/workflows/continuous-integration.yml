# GitHub Actions configuration file : Continuous Integration

name: Continuous integration

# Trigger the workflow on push or pull request, for master branch only.
on:
  push:
    branches:
      - master
  pull_request:
    branches:
      - master

jobs:
  windows-test:
    name: Test Windows installation
    runs-on: windows-latest
    steps:
    - uses: actions/checkout@master
    - name: Install libsrt
      run: |
        .\install-libsrt.ps1 -NoPause
        # Propagate LIBSRT in next jobs.
        $libsrt = [System.Environment]::GetEnvironmentVariable("LIBSRT","Machine")
        Write-Output "::set-env name=LIBSRT::$libsrt"
    - name: Check installation
      run: |
        # Check if the environment variable is correctly passed from job to job.
        Write-Output "LIBSRT='$($env:LIBSRT)'"
        Get-ChildItem 'C:\Program Files*\libsrt'
        Get-ChildItem $($env:LIBSRT)

